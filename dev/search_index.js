var documenterSearchIndex = {"docs":
[{"location":"api/#Library-Reference","page":"Library Reference","title":"Library Reference","text":"","category":"section"},{"location":"api/","page":"Library Reference","title":"Library Reference","text":"Modules = [\n  CategoricalTensorNetworks.TensorNetworkAlgebras,\n  CategoricalTensorNetworks.ScheduleUWDs,\n]","category":"page"},{"location":"api/#CategoricalTensorNetworks.TensorNetworkAlgebras","page":"Library Reference","title":"CategoricalTensorNetworks.TensorNetworkAlgebras","text":"Tensor networks as algebras of the operad of undirected wiring diagrams.\n\n\n\n\n\n","category":"module"},{"location":"api/#CategoricalTensorNetworks.TensorNetworkAlgebras.contract_tensor_network-Tuple{Catlab.WiringDiagrams.UndirectedWiringDiagrams.AbstractUWD, AbstractVector{<:AbstractArray}}","page":"Library Reference","title":"CategoricalTensorNetworks.TensorNetworkAlgebras.contract_tensor_network","text":"Contract a tensor network all at once.\n\nPerforms a generalized contraction of a list of tensors of arbitrary rank. In the binary case, this function includes matrix multiplication, tensor product, and trace as special cases. In general, it implements the \"generalized matrix multiplication\" described in Spivak et al's \"Pixel Arrays\".\n\nBe warned that this method is inefficient for contracting networks with more than two junctions. Specifically, if the network has n junctions with dimensions k₁  kₙ, then this function performs exactly k₁  kₙ multiplications in the base ring (or rig). For example, a binary matrix multiply of square matrices performs k³ multiplications. A ternary matrix multiply performs k⁴ multiplications, whereas a sequence of two binary multiplies performs 2k³. Thus, when there are more than two junctions, it is usually better to schedule a computation using schedule or another package, possibly via @contract_tensors_with.\n\nIn addition to the method taking an undirected wiring diagram, this function has methods similar to the ncon (\"Network CONtractor\") function in:\n\nthe NCON package for MATLAB\nthe Julia package TensorOperations.jl\n\nexcept that here the outer junctions are represented explictly by a third argument rather than implicitly by using negative numbers in the second argument.\n\n\n\n\n\n","category":"method"},{"location":"api/#CategoricalTensorNetworks.TensorNetworkAlgebras.gen_tensor_notation-Tuple{Catlab.WiringDiagrams.UndirectedWiringDiagrams.AbstractUWD}","page":"Library Reference","title":"CategoricalTensorNetworks.TensorNetworkAlgebras.gen_tensor_notation","text":"Generate Julia expression in tensor notation from undirected wiring diagram.\n\nThis function is used to implement @contract_tensors_with but may be useful in its own right.\n\nSee also @tensor_network, the \"inverse\" to this function.\n\n\n\n\n\n","category":"method"},{"location":"api/#CategoricalTensorNetworks.TensorNetworkAlgebras.parse_tensor_network-Tuple{Expr, Expr}","page":"Library Reference","title":"CategoricalTensorNetworks.TensorNetworkAlgebras.parse_tensor_network","text":"Parse an undirected wiring diagram from a tensor expression.\n\nFor more information, see the corresponding macro @tensor_network.\n\n\n\n\n\n","category":"method"},{"location":"api/#Catlab.WiringDiagrams.WiringDiagramAlgebras.oapply-Tuple{Catlab.WiringDiagrams.UndirectedWiringDiagrams.AbstractUWD, AbstractVector{<:AbstractArray}}","page":"Library Reference","title":"Catlab.WiringDiagrams.WiringDiagramAlgebras.oapply","text":"Contract tensors according to UWD.\n\nThis method simply wraps contract_tensor_network, which also presents an interface closer to the standard tensor algebra packages.\n\n\n\n\n\n","category":"method"},{"location":"api/#CategoricalTensorNetworks.TensorNetworkAlgebras.@contract_tensors_with-Tuple{Any, Any}","page":"Library Reference","title":"CategoricalTensorNetworks.TensorNetworkAlgebras.@contract_tensors_with","text":"Contract a tensor network using a macro from another package.\n\nThis macro takes two arguments: an undirected wiring diagram and a macro call supporting the tensor contraction notation that is de facto standard among Julia tensor packages. For example, to evaluate a tensor network using the @tullio macro, use:\n\nA = @contract_tensors_with @tullio diagram\n\nThe following macros should work:\n\n@tensor from TensorOperations.jl.\n@tullio from Tullio.jl\n@einsum from Einsum.jl\n@ein from OMEinsum.jl\n\nHowever, the macros @cast and @reduce from TensorCast.jl will not work because they do not support implicit summation.\n\n\n\n\n\n","category":"macro"},{"location":"api/#CategoricalTensorNetworks.TensorNetworkAlgebras.@tensor_network-Tuple","page":"Library Reference","title":"CategoricalTensorNetworks.TensorNetworkAlgebras.@tensor_network","text":"Construct an undirected wiring diagram using tensor notation.\n\nThe syntax is compatible with the Einstein-style tensor notation used by tensor algebra packages like TensorOperations.jl and TensorCast.jl. For example, the wiring diagram for the composite of two matrices (or two binary relations) is constructed by\n\n@tensor_network (i,j,k) C[i,k] := A[i,j] * B[j,k]\n\nThe leading context, or list of variables, may be omitted, in which case it is inferred from the variables used in the tensor expression. So, in this example, an equivalent macro call is\n\n@tensor_network C[i,k] := A[i,j] * B[j,k]\n\nSee also: gen_tensor_notation, the \"inverse\" to this macro.\n\n\n\n\n\n","category":"macro"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs","text":"Scheduling and evaluation of undirected wiring diagrams.\n\nIn category-theoretic terms, this module is about evaluating arbitrary composites of morphisms in hypergraph categories.\n\n\n\n\n\n","category":"module"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.HasNestedUWD","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.HasNestedUWD","text":"Abstract type for C-sets that contained a nested UWD.\n\n\n\n\n\n","category":"type"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.HasScheduledUWD","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.HasScheduledUWD","text":"Abstract type for C-sets that contain a scheduled UWDS.\n\nThis type includes ScheduledUWD and NestedUWD.\n\n\n\n\n\n","category":"type"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.NestedUWD","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.NestedUWD","text":"Nested undirected wiring diagram.\n\nA nested UWD is a scheduled UWD whose composite nodes have been given ports, making explicit the intermediate boxes in the composition.\n\nNested UWDs are very similar but not quite identical to Robin Milner's bigraphs.\n\nSee also: ScheduledUWD.\n\n\n\n\n\n","category":"type"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.ScheduledUWD","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.ScheduledUWD","text":"Scheduled undirected wiring diagram.\n\nA scheduled UWD consists of a UWD together with a set of composite nodes forming a rooted tree, or in general a rooted forest, whose leaves are the diagram's boxes.\n\nSee also: NestedUWD.\n\n\n\n\n\n","category":"type"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.SequentialSchedule","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.SequentialSchedule","text":"Schedule diagram as a sequential chain of binary composites.\n\nThis is the simplest possible scheduling algorithm, the equivalent of foldl for undirected wiring diagrams. Unless otherwise specified, the boxes are folded according to the order of their IDs, which is arbitrary.\n\n\n\n\n\n","category":"type"},{"location":"api/#Base.schedule-Tuple{Catlab.WiringDiagrams.UndirectedWiringDiagrams.AbstractUWD}","page":"Library Reference","title":"Base.schedule","text":"Schedule an undirected wiring diagram.\n\nBy default, a simple sequential schedule is used.\n\n\n\n\n\n","category":"method"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.eval_schedule-Tuple{Any, AbstractVector}","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.eval_schedule","text":"Evaluate a scheduled UWD given a set of generators for the boxes.\n\nThe optional first argument f should be a callable with the same signature as oapply for UWD algebras, which by default is oapply itself.\n\nf(composite::UndirectedWiringDiagram, values::AbstractVector)\n\nNested UWDs are used as an auxiliary data structure during the evaluation. If the schedule will be evaluated multiple times, you should explicitly convert it to a nested UWD using to_nested_diagram and then call eval_schedule on the resulting object instead.\n\n\n\n\n\n","category":"method"},{"location":"api/#CategoricalTensorNetworks.ScheduleUWDs.to_nested_diagram-Tuple{AbstractScheduledUWD}","page":"Library Reference","title":"CategoricalTensorNetworks.ScheduleUWDs.to_nested_diagram","text":"Convert a scheduled UWD to a nested UWD.\n\n\n\n\n\n","category":"method"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"EditURL = \"../../literate/pixel_array_example.jl\"","category":"page"},{"location":"generated/pixel_array_example/#Pixel-arrays:-higher-order-example","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"","category":"section"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"This notebook reproduces Exampe 2.4.2 from the pixel arrays paper (arXiv:1609.00061).","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"using Catlab, Catlab.CategoricalAlgebra.FinRelations\nusing CategoricalTensorNetworks\n\nusing Tullio","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"Base relations:","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"beginaligned\n   R_1(w yx) iff tan(y+w) + exp(x) = 2 \n   R_2(xv y) iff x^3 + cos(log(y^2)) = 15v \n   R_3(w vz) iff w + z + 10^-1 v = 05\nendaligned","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"Create the pixel arrays.","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"n = 80\nv = x = z = range(-3, 3, length=n)\nw = y = range(-2.5, 2.5, length=n)\nϵ = 0.1\n\n@tullio R1[i,j,k] := BoolRig(abs(tan(y[k] + w[i]) + exp(x[j]) - 2) < ϵ)\n@tullio R2[i,j,k] := BoolRig(abs(x[j]^3 + cos(log(y[k]^2)) - 1.5v[i]) < ϵ)\n@tullio R3[i,j,k] := BoolRig(abs(w[j] + z[k] + v[i]/10 - 0.5) < ϵ)\n\nsize(R1)","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"Create undirected wiring diagram for relational composition.","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"diagram = @relation (w,y) where (v,w,x,y,z) begin\n  R1(w,x,y)\n  R2(v,x,y)\n  R3(v,w,z)\nend\n\nto_graphviz(diagram, box_labels=:name, junction_labels=:variable,\n            port_labels=false)","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"This diagram corresponds to the tensor contraction expression:","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"gen_tensor_notation(diagram)","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"Evaluate this tensor network using Tullio.jl.","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"R = @contract_tensors_with diagram @tullio;\nnothing #hide","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"Plot the result.","category":"page"},{"location":"generated/pixel_array_example/","page":"Pixel arrays: higher-order example","title":"Pixel arrays: higher-order example","text":"using Plots\n\nplot_rel(m::AbstractMatrix{BoolRig}; kw...) =\n  plot(spy(map(x -> x.value, m)); kw...)\n\nticks = range(1, n, length=5)\nticklabels = range(minimum(w), maximum(w), length=length(ticks))\nplot_rel(R, title=\"Composite relation\", xlabel=\"y\", ylabel=\"w\",\n         size=(300,300), lims=(0,n), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"EditURL = \"../../literate/pixel_matrix_more_examples.jl\"","category":"page"},{"location":"generated/pixel_matrix_more_examples/#Pixel-matrices:-more-examples","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"","category":"section"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"This notebook reproduces further examples from the pixel arrays paper (arXiv:1609.00061).","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"using Catlab, Catlab.CategoricalAlgebra.FinRelations\n\nusing Convex, SCS, TikzPictures\nusing Plots\n\nplot_rel(m::AbstractMatrix{BoolRig}; kw...) =\n  plot(spy(map(x -> x.value, m)); kw...)","category":"page"},{"location":"generated/pixel_matrix_more_examples/#Example-2.4.1","page":"Pixel matrices: more examples","title":"Example 2.4.1","text":"","category":"section"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"$ R_1(x; z) \\iff \\cos(\\log(z^2 + 10^{-3} x)) - x + 10^{-5} z^{-1} = 0 $","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"dim = 500\nw = y = x = z = range(-3, 3, length=dim)\nϵ = (maximum(w) - minimum(w)) / dim\n\nR1_mat = FinRelation(Matrix{BoolRig}(\n  @. abs(cos(log(Complex(z^2 + 10^-3 * x'))) - x' + 10^-5 / z) < ϵ\n))\n\nticks = range(1, dim, length=5)\nticklabels = range(-3, 3, length=length(ticks))\nplot_rel(R1_mat.rel, title=\"Equation 1\", xlabel=\"x\", ylabel=\"z\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"$ R_2(w; y) \\iff \\cosh(w + 10^{-3} y) + y + 10^{-4} w = 2 $","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"R2_mat = FinRelation(Matrix{BoolRig}(\n  @. abs(cosh(w' + 10^-3 * y) + y + 10^-4 * w' - 2) < ϵ\n))\n\nplot_rel(R2_mat.rel, title=\"Equation 2\", xlabel=\"w\", ylabel=\"y\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"$ R_3(x; y) \\iff \\tan(x+y) (x-2)^{-1} (x+3)^{-1} y^{-2} = 1 $","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"R3_mat = FinRelation(Matrix{BoolRig}(\n  @. abs(tan(x'+y) / (x'-2) / (x'+3) / y^2 - 1) < ϵ\n))\n\nplot_rel(R3_mat.rel, title=\"Equation 3\", xlabel=\"x\", ylabel=\"y\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"Compute and plot the composite relation.","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"W, X, Y, Z = Ob(FreeBicategoryRelations, \"w\", \"x\", \"y\", \"z\")\nR1 = Hom(\"R_1\", X, Z)\nR2 = Hom(\"R_2\", W, Y)\nR3 = Hom(\"R_3\", X, Y)\n\ncomposite = R2 ⋅ dagger(R3) ⋅ R1\n\nto_tikz(composite, orientation=LeftToRight, labels=true)\n\nob = FinRel(dim)\ncomposite_mat = functor((FinRel, FinRelation), composite, generators=Dict(\n  W => ob, X => ob, Y => ob, Z => ob,\n  R1 => R1_mat, R2 => R2_mat, R3 => R3_mat,\n))\n\nplot_rel(composite_mat.rel, title=\"Result\", xlabel=\"w\", ylabel=\"z\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_more_examples/#Example-2.4.2","page":"Pixel matrices: more examples","title":"Example 2.4.2","text":"","category":"section"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"beginaligned\n   R_1(w yx) iff tan(y+w) + exp(x) = 2 \n   R_2(xv y) iff x^3 + cos(log(y^2)) = 15v \n   R_3(w vz) iff w + z + 10^-1 v = 05\nendaligned","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"V, W, X, Y, Z = Ob(FreeBicategoryRelations, \"v\", \"w\", \"x\", \"y\", \"z\")\nR1 = Hom(\"R_1\", W, Y⊗X)\nR2 = Hom(\"R_2\", X⊗V, Y)\nR3 = Hom(\"R_3\", W, V⊗Z)\n\ncomposite = mcopy(W)⋅(R1 ⊗ R3)⋅(id(Y) ⊗ R2 ⊗ delete(Z))⋅mmerge(Y)","category":"page"},{"location":"generated/pixel_matrix_more_examples/","page":"Pixel matrices: more examples","title":"Pixel matrices: more examples","text":"to_tikz(composite, orientation=LeftToRight, labels=true)","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"EditURL = \"../../literate/pixel_matrix_simple_example.jl\"","category":"page"},{"location":"generated/pixel_matrix_simple_example/#Pixel-matrices:-simple-example","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"","category":"section"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"This notebook reproduces the simple example at the beginning of the pixel arrays paper (arXiv:1609.00061).","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"using Catlab.Theories, Catlab.CategoricalAlgebra.FinRelations\nusing Plots\n\nplot_rel(m::AbstractMatrix{BoolRig}; kw...) =\n  plot(spy(map(x -> x.value, m)); kw...)","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"Plot the relation $ R(x,w) \\iff x^2 = w $","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"dim = 250\nw = x = y = range(-1.5, 1.5, length=dim)\nϵ = (maximum(w) - minimum(w)) / dim\n\nR = FinRelation(Matrix{BoolRig}(@. abs((x')^2 - w) < ϵ))\n\nticks = range(1, dim, length=5)\nticklabels = range(minimum(w), maximum(w), length=length(ticks))\nplot_rel(R.rel, xlabel=\"x\", ylabel=\"w\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"Plot the relation $ S(w,y) \\iff w = 1 - y^2 $","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"S = FinRelation(Matrix{BoolRig}(@. abs(w' - (1 - y^2)) < ϵ))\n\nplot_rel(S.rel, xlabel=\"w\", ylabel=\"y\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"Compute the composite relation, and plot it.","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"$ (R \\cdot S)(x,y) \\iff \\exists w: R(x,w) \\wedge S(w,y) $","category":"page"},{"location":"generated/pixel_matrix_simple_example/","page":"Pixel matrices: simple example","title":"Pixel matrices: simple example","text":"composite = R⋅S\n\nplot_rel(composite.rel, xlabel=\"x\", ylabel=\"y\",\n         size=(300,300), lims=(0,dim), ticks=(ticks,ticklabels))","category":"page"},{"location":"#CategoricalTensorNetworks.jl","page":"CategoricalTensorNetworks.jl","title":"CategoricalTensorNetworks.jl","text":"","category":"section"},{"location":"","page":"CategoricalTensorNetworks.jl","title":"CategoricalTensorNetworks.jl","text":"CurrentModule = CategoricalTensorNetworks","category":"page"},{"location":"","page":"CategoricalTensorNetworks.jl","title":"CategoricalTensorNetworks.jl","text":"CategoricalTensorNetworks.jl is a Julia package for tensor networks from a categorical point of view. Tensor networks are viewed as algebras of the operad of the undirected wiring diagrams.","category":"page"}]
}
